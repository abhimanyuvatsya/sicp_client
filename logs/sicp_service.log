2025-09-22 17:40:29 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 17:40:29 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 17:40:29 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 17:40:29 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 17:40:29 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 17:40:29 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 127.0.0.1:5000: Unable to reach 127.0.0.1:5000: [Errno 1] Operation not permitted
2025-09-22 17:40:30 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 127.0.0.1:5000: Unable to reach 127.0.0.1:5000: [Errno 1] Operation not permitted
2025-09-22 17:40:31 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 127.0.0.1:5000: Unable to reach 127.0.0.1:5000: [Errno 1] Operation not permitted
2025-09-22 17:41:08 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 17:41:08 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 17:41:08 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 17:41:08 INFO [uvicorn.error] Started server process [8094]
2025-09-22 17:41:08 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 17:41:08 INFO [sicp_service.mqtt] Connecting to MQTT broker localhost:1883
2025-09-22 17:41:08 INFO [uvicorn.error] Application startup complete.
2025-09-22 17:41:08 ERROR [uvicorn.error] [Errno 1] error while attempting to bind on address ('127.0.0.1', 8080): [errno 1] operation not permitted
2025-09-22 17:41:08 INFO [uvicorn.error] Waiting for application shutdown.
2025-09-22 17:41:08 INFO [uvicorn.error] Application shutdown complete.
2025-09-22 17:41:08 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 17:41:08 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 127.0.0.1:5000: Unable to reach 127.0.0.1:5000: [Errno 1] Operation not permitted
2025-09-22 17:41:09 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 127.0.0.1:5000: Unable to reach 127.0.0.1:5000: [Errno 1] Operation not permitted
2025-09-22 17:41:10 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 127.0.0.1:5000: Unable to reach 127.0.0.1:5000: [Errno 1] Operation not permitted
2025-09-22 17:43:46 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 17:43:46 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 17:43:46 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 17:43:46 INFO [uvicorn.error] Started server process [8555]
2025-09-22 17:43:46 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 17:43:46 INFO [sicp_service.mqtt] Connecting to MQTT broker localhost:1883
2025-09-22 17:43:46 INFO [uvicorn.error] Application startup complete.
2025-09-22 17:43:46 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 17:43:49 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 17:43:49 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:43:49 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.92:5000: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:43:50 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:43:50 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.18:5000: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:43:53 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:43:53 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 17:43:53 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.92:5000: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:43:54 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:43:54 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.18:5000: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:43:54 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: [Errno 64] Host is down
2025-09-22 17:43:54 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: [Errno 64] Host is down
2025-09-22 17:43:54 WARNING [sicp_service.manager] Communication failure with office: Unable to reach 192.168.2.98:5000: [Errno 64] Host is down
2025-09-22 17:43:54 WARNING [sicp_service.manager] Communication failure with bathroom: Unable to reach 192.168.2.189:5000: [Errno 64] Host is down
2025-09-22 17:43:57 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.92:5000: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:43:57 WARNING [sicp_service.manager] Communication failure with hallway: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:43:58 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:43:58 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:43:58 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.18:5000: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:43:58 WARNING [sicp_service.manager] Communication failure with guest: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:44:27 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:44:29 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 17:44:31 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:44:31 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.92:5000: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:44:31 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.18:5000: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:44:33 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:44:34 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 17:44:35 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.92:5000: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:44:35 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.18:5000: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:44:35 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:44:38 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:44:39 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.92:5000: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:44:39 WARNING [sicp_service.manager] Communication failure with hallway: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:44:39 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 17:44:39 WARNING [sicp_service.manager] Communication failure with bathroom: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 17:44:39 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.18:5000: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:44:39 WARNING [sicp_service.manager] Communication failure with guest: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:44:40 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:44:42 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:44:42 WARNING [sicp_service.manager] Communication failure with office: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:44:44 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:44:44 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:45:12 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.92:5000: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:45:13 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.18:5000: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:45:13 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 17:45:16 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.92:5000: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:45:17 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:45:17 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.18:5000: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:45:18 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:45:18 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 17:45:20 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.92:5000: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:45:20 WARNING [sicp_service.manager] Communication failure with hallway: Unable to reach 192.168.2.92:5000: timed out
2025-09-22 17:45:21 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.18:5000: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:45:21 WARNING [sicp_service.manager] Communication failure with guest: Unable to reach 192.168.2.18:5000: timed out
2025-09-22 17:45:22 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:45:22 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:45:24 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 17:45:24 WARNING [sicp_service.manager] Communication failure with bathroom: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 17:45:27 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:45:27 WARNING [sicp_service.manager] Communication failure with office: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 17:45:27 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:45:27 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:45:38 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 17:45:38 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 17:45:40 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 17:45:40 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 17:45:40 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 17:45:40 INFO [uvicorn.error] Started server process [8716]
2025-09-22 17:45:40 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 17:45:40 INFO [sicp_service.mqtt] Connecting to MQTT broker localhost:1883
2025-09-22 17:45:40 INFO [uvicorn.error] Application startup complete.
2025-09-22 17:45:40 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 17:45:43 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:45:48 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:45:49 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 17:45:49 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 17:45:52 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:45:57 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:46:26 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 17:46:26 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 17:46:26 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 17:46:26 INFO [uvicorn.error] Started server process [8843]
2025-09-22 17:46:26 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 17:46:26 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 17:46:26 INFO [uvicorn.error] Application startup complete.
2025-09-22 17:46:26 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 17:46:30 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:46:35 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:46:39 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:46:39 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:47:13 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:47:17 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:47:21 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:47:21 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:47:54 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:47:57 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 17:47:57 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 17:47:59 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:48:35 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 17:48:35 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 17:48:35 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 17:48:35 INFO [uvicorn.error] Started server process [9047]
2025-09-22 17:48:35 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 17:48:35 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 17:48:35 INFO [uvicorn.error] Application startup complete.
2025-09-22 17:48:35 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 17:48:38 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:48:42 INFO [uvicorn.access] 127.0.0.1:56230 - "GET / HTTP/1.1" 200
2025-09-22 17:48:42 INFO [uvicorn.access] 127.0.0.1:56230 - "GET /favicon.ico HTTP/1.1" 404
2025-09-22 17:48:43 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:48:46 INFO [uvicorn.access] 127.0.0.1:56230 - "GET /logs HTTP/1.1" 200
2025-09-22 17:48:48 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:48:48 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:49:21 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:49:25 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:49:31 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:49:31 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:50:04 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:50:08 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 17:50:08 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 17:50:08 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:50:13 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:50:18 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:51:20 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 17:51:20 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 17:51:20 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 17:51:20 INFO [uvicorn.error] Started server process [9435]
2025-09-22 17:51:20 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 17:51:20 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 17:51:20 INFO [uvicorn.error] Application startup complete.
2025-09-22 17:51:20 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 17:51:24 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:51:28 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:51:32 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:51:32 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:52:06 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:52:11 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:52:15 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:52:15 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:52:17 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 17:52:17 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 17:52:18 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 17:52:18 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 17:52:18 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 17:52:18 INFO [uvicorn.error] Started server process [9584]
2025-09-22 17:52:18 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 17:52:18 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 17:52:18 INFO [uvicorn.error] Application startup complete.
2025-09-22 17:52:18 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 17:52:27 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:52:35 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:52:38 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 17:52:38 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 17:52:43 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:53:42 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 17:53:42 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 17:53:42 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 17:53:42 INFO [uvicorn.error] Started server process [10080]
2025-09-22 17:53:42 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 17:53:42 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 17:53:42 INFO [uvicorn.error] Application startup complete.
2025-09-22 17:53:42 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 17:53:51 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:53:59 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:54:05 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:54:05 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:54:21 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 17:54:21 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 17:58:14 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 17:58:14 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 17:58:14 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 17:58:14 INFO [uvicorn.error] Started server process [11113]
2025-09-22 17:58:14 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 17:58:14 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 17:58:14 INFO [uvicorn.error] Application startup complete.
2025-09-22 17:58:14 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 17:58:19 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:58:25 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:58:31 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:58:32 INFO [uvicorn.access] 127.0.0.1:56416 - "GET / HTTP/1.1" 200
2025-09-22 17:58:32 INFO [uvicorn.access] 127.0.0.1:56416 - "GET /favicon.ico HTTP/1.1" 404
2025-09-22 17:58:36 INFO [sicp_service.manager] Setting LED on spare to True #FF0000
2025-09-22 17:58:36 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 17:58:36 INFO [uvicorn.access] 127.0.0.1:56416 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 17:58:36 INFO [uvicorn.access] 127.0.0.1:56416 - "GET / HTTP/1.1" 200
2025-09-22 17:58:41 INFO [sicp_service.manager] Setting LED on spare to True #0433FF
2025-09-22 17:58:42 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 17:58:42 INFO [uvicorn.access] 127.0.0.1:56416 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 17:58:42 INFO [uvicorn.access] 127.0.0.1:56416 - "GET / HTTP/1.1" 200
2025-09-22 17:58:45 INFO [sicp_service.manager] Setting LED on spare to True #942192
2025-09-22 17:58:45 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 17:58:45 INFO [uvicorn.access] 127.0.0.1:56416 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 17:58:45 INFO [uvicorn.access] 127.0.0.1:56416 - "GET / HTTP/1.1" 200
2025-09-22 17:58:49 INFO [sicp_service.manager] Setting LED on spare to True #FFFFFF
2025-09-22 17:58:50 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 17:58:50 INFO [uvicorn.access] 127.0.0.1:56416 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 17:58:50 INFO [uvicorn.access] 127.0.0.1:56416 - "GET / HTTP/1.1" 200
2025-09-22 17:58:54 INFO [sicp_service.manager] Setting LED on spare to True #FFFFFF
2025-09-22 17:58:54 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 17:58:54 INFO [uvicorn.access] 127.0.0.1:56416 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 17:58:54 INFO [uvicorn.access] 127.0.0.1:56416 - "GET / HTTP/1.1" 200
2025-09-22 17:58:57 INFO [sicp_service.manager] Setting LED on spare to True #000000
2025-09-22 17:58:57 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 17:58:57 INFO [uvicorn.access] 127.0.0.1:56416 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 17:58:57 INFO [uvicorn.access] 127.0.0.1:56416 - "GET / HTTP/1.1" 200
2025-09-22 17:59:07 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:59:13 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:59:19 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:59:19 INFO [sicp_service.manager] Setting LED on spare to True #444444
2025-09-22 17:59:19 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 17:59:19 INFO [uvicorn.access] 127.0.0.1:56427 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 17:59:19 INFO [sicp_service.manager] Setting LED on spare to True #AAAAAA
2025-09-22 17:59:19 INFO [uvicorn.access] 127.0.0.1:56427 - "GET / HTTP/1.1" 200
2025-09-22 17:59:20 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 17:59:20 INFO [sicp_service.manager] Setting LED on spare to True #004D65
2025-09-22 17:59:20 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 17:59:25 INFO [sicp_service.manager] Setting LED on spare to True #FF2600
2025-09-22 17:59:25 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 17:59:25 INFO [uvicorn.access] 127.0.0.1:56436 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 17:59:25 INFO [uvicorn.access] 127.0.0.1:56436 - "GET / HTTP/1.1" 200
2025-09-22 17:59:27 INFO [sicp_service.manager] Setting power on spare to False
2025-09-22 17:59:32 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:59:38 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:59:44 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:59:44 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:59:44 INFO [uvicorn.access] 127.0.0.1:56436 - "POST /api/tablets/spare/power HTTP/1.1" 200
2025-09-22 17:59:44 INFO [sicp_service.manager] Setting power on spare to True
2025-09-22 17:59:44 INFO [uvicorn.access] 127.0.0.1:56436 - "GET / HTTP/1.1" 200
2025-09-22 17:59:51 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 17:59:57 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:00:03 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:00:03 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:00:03 INFO [sicp_service.manager] Setting power on spare to True
2025-09-22 18:00:08 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:00:14 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:00:20 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:00:20 WARNING [sicp_service.manager] Communication failure with spare: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:00:20 INFO [sicp_service.manager] Setting LED on spare to True #000000
2025-09-22 18:00:20 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 18:00:20 INFO [sicp_service.manager] Setting LED on spare to True #FFFFFF
2025-09-22 18:00:21 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 18:00:21 INFO [uvicorn.access] 127.0.0.1:56436 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:00:26 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:00:32 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:00:38 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:01:00 INFO [uvicorn.access] 127.0.0.1:56471 - "GET / HTTP/1.1" 200
2025-09-22 18:01:06 INFO [sicp_service.manager] Setting LED on spare to True #000000
2025-09-22 18:01:06 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 18:01:06 INFO [uvicorn.access] 127.0.0.1:56473 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:01:06 INFO [uvicorn.access] 127.0.0.1:56473 - "GET / HTTP/1.1" 200
2025-09-22 18:01:14 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:01:20 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:01:26 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:01:26 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:01:26 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:01:28 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 18:01:28 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:01:28 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:01:28 INFO [uvicorn.error] Started server process [11406]
2025-09-22 18:01:28 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:01:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:01:28 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:01:28 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:01:28 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:01:28 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 06 00 00 18 00 1E
2025-09-22 18:01:33 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:01:39 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:01:45 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:02:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:02:15 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 06 00 00 18 00 1E
2025-09-22 18:02:20 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:02:26 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:02:32 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:03:02 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:03:03 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 06 00 00 18 00 1E
2025-09-22 18:03:08 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:03:14 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:03:20 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.71:5000: Unable to reach 192.168.2.71:5000: timed out
2025-09-22 18:03:30 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:03:30 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:04:26 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 18:04:26 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:04:26 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:04:27 INFO [uvicorn.error] Started server process [11679]
2025-09-22 18:04:27 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:04:27 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:04:27 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:04:27 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:04:27 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:04:27 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:04:55 INFO [uvicorn.access] 127.0.0.1:56561 - "GET / HTTP/1.1" 200
2025-09-22 18:04:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:04:58 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:05:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:05:29 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:05:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:06:00 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:06:02 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:06:02 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:06:03 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 18:06:03 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:06:03 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:06:03 INFO [uvicorn.error] Started server process [11830]
2025-09-22 18:06:03 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:06:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:06:03 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:06:03 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:06:03 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:06:03 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:06:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:06:34 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:07:01 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:07:01 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 89, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:07:27 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 18:07:27 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:07:27 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:07:27 INFO [uvicorn.error] Started server process [12050]
2025-09-22 18:07:27 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:07:27 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:07:27 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:07:27 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:07:27 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:07:27 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:07:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:07:58 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:08:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:08:29 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:08:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:09:00 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:09:16 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:09:16 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 90, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:09:46 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 18:09:46 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:09:46 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:09:46 INFO [uvicorn.error] Started server process [12250]
2025-09-22 18:09:46 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:09:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:09:46 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:09:46 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:09:46 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:09:46 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:10:12 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:10:12 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 69, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 76, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 90, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 343, in __init__
    self._client.message_retry_set(message_retry_set)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Client' object has no attribute 'message_retry_set'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:10:20 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 18:10:20 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:10:20 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:10:20 INFO [uvicorn.error] Started server process [12513]
2025-09-22 18:10:20 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:10:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:10:20 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:10:20 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:10:20 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:10:20 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4457454896
2025-09-22 18:10:20 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:10:20 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:10:20 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:10:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:10:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:10:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:11:22 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:11:22 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:11:26 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":255,"g":137,"b":14}}
2025-09-22 18:11:26 INFO [sicp_service.manager] Setting LED on spare to True #FF890E
2025-09-22 18:11:26 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 89 0E 82
2025-09-22 18:11:27 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 18:11:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:11:54 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:11:58 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:11:58 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:11:58 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:11:58 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:11:58 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:11:59 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 18:11:59 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:11:59 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:11:59 INFO [uvicorn.error] Started server process [12671]
2025-09-22 18:11:59 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:11:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:11:59 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:11:59 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:11:59 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:11:59 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4457438512
2025-09-22 18:11:59 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:11:59 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:11:59 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:12:00 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:12:03 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":255,"g":158,"b":243}}
2025-09-22 18:12:03 INFO [sicp_service.manager] Setting LED on spare to True #FF9EF3
2025-09-22 18:12:03 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 9E F3 68
2025-09-22 18:12:04 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 18:12:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:12:31 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:12:37 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":96,"g":255,"b":61}}
2025-09-22 18:12:37 INFO [sicp_service.manager] Setting LED on spare to True #60FF3D
2025-09-22 18:12:37 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 60 FF 3D 58
2025-09-22 18:12:37 WARNING [sicp_service.manager] Communication failure with spare: Frame too short to parse LED status: 060101000600
2025-09-22 18:13:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:02 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:13:08 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:13:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:13:08 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:13:08 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:13:08 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:13:10 INFO [sicp_service.manager] Starting tablet manager with 1 tablets
2025-09-22 18:13:10 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:13:10 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:13:10 INFO [uvicorn.error] Started server process [12819]
2025-09-22 18:13:10 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:13:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:10 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:13:10 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:13:10 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:13:10 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4485994480
2025-09-22 18:13:10 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:13:10 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:13:10 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:13:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:13:17 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","brightness":255}
2025-09-22 18:13:17 INFO [sicp_service.manager] Setting LED on spare to True #000000
2025-09-22 18:13:17 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 00 00 FA
2025-09-22 18:13:18 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:25 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":92,"g":255,"b":63}}
2025-09-22 18:13:25 INFO [sicp_service.manager] Setting LED on spare to True #5CFF3F
2025-09-22 18:13:25 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 5C FF 3F 66
2025-09-22 18:13:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:26 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":62,"g":255,"b":48}}
2025-09-22 18:13:26 INFO [sicp_service.manager] Setting LED on spare to True #3EFF30
2025-09-22 18:13:26 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 3E FF 30 0B
2025-09-22 18:13:27 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:27 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":62,"g":255,"b":48}}
2025-09-22 18:13:27 INFO [sicp_service.manager] Setting LED on spare to True #3EFF30
2025-09-22 18:13:27 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 3E FF 30 0B
2025-09-22 18:13:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:28 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":132,"g":255,"b":165}}
2025-09-22 18:13:28 INFO [sicp_service.manager] Setting LED on spare to True #84FFA5
2025-09-22 18:13:28 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 84 FF A5 24
2025-09-22 18:13:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:29 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":25,"g":255,"b":52}}
2025-09-22 18:13:29 INFO [sicp_service.manager] Setting LED on spare to True #19FF34
2025-09-22 18:13:29 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 19 FF 34 28
2025-09-22 18:13:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:30 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":20,"g":255,"b":43}}
2025-09-22 18:13:30 INFO [sicp_service.manager] Setting LED on spare to True #14FF2B
2025-09-22 18:13:30 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 14 FF 2B 3A
2025-09-22 18:13:31 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:31 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":62,"g":255,"b":48}}
2025-09-22 18:13:31 INFO [sicp_service.manager] Setting LED on spare to True #3EFF30
2025-09-22 18:13:31 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 3E FF 30 0B
2025-09-22 18:13:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:34 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":59,"g":38,"b":255}}
2025-09-22 18:13:34 INFO [sicp_service.manager] Setting LED on spare to True #3B26FF
2025-09-22 18:13:34 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 3B 26 FF 18
2025-09-22 18:13:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:41 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:13:41 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:13:55 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":255,"g":107,"b":136}}
2025-09-22 18:13:55 INFO [sicp_service.manager] Setting LED on spare to True #FF6B88
2025-09-22 18:13:55 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 6B 88 E6
2025-09-22 18:13:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:09 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":255,"g":163,"b":15}}
2025-09-22 18:14:09 INFO [sicp_service.manager] Setting LED on spare to True #FFA30F
2025-09-22 18:14:09 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF A3 0F A9
2025-09-22 18:14:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:11 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":255,"g":215,"b":96}}
2025-09-22 18:14:11 INFO [sicp_service.manager] Setting LED on spare to True #FFD760
2025-09-22 18:14:11 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF D7 60 B2
2025-09-22 18:14:11 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:12 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:12 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":255,"g":104,"b":122}}
2025-09-22 18:14:12 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:14:13 INFO [sicp_service.manager] Setting LED on spare to True #FF687A
2025-09-22 18:14:13 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 68 7A 17
2025-09-22 18:14:13 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:14 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":255,"g":0,"b":25}}
2025-09-22 18:14:14 INFO [sicp_service.manager] Setting LED on spare to True #FF0019
2025-09-22 18:14:14 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 19 1C
2025-09-22 18:14:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:15 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":255,"g":0,"b":25}}
2025-09-22 18:14:15 INFO [sicp_service.manager] Setting LED on spare to True #FF0019
2025-09-22 18:14:15 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 19 1C
2025-09-22 18:14:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:16 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON","color":{"r":255,"g":0,"b":25}}
2025-09-22 18:14:16 INFO [sicp_service.manager] Setting LED on spare to True #FF0019
2025-09-22 18:14:16 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 19 1C
2025-09-22 18:14:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:35 INFO [uvicorn.access] 127.0.0.1:56814 - "GET / HTTP/1.1" 200
2025-09-22 18:14:37 INFO [sicp_service.manager] Setting LED on spare to False #FF0019
2025-09-22 18:14:37 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:14:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:37 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #FF0019
2025-09-22 18:14:37 INFO [uvicorn.access] 127.0.0.1:56814 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:14:37 INFO [uvicorn.access] 127.0.0.1:56814 - "GET / HTTP/1.1" 200
2025-09-22 18:14:38 INFO [sicp_service.manager] Setting LED on spare to True #FF0019
2025-09-22 18:14:38 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 19 1C
2025-09-22 18:14:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:39 INFO [uvicorn.access] 127.0.0.1:56814 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:14:39 INFO [uvicorn.access] 127.0.0.1:56814 - "GET / HTTP/1.1" 200
2025-09-22 18:14:43 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:43 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:14:47 INFO [sicp_service.manager] Setting LED on spare to True #FF2600
2025-09-22 18:14:47 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 26 00 23
2025-09-22 18:14:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:48 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:14:48 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:14:50 INFO [sicp_service.manager] Setting LED on spare to True #FF2600
2025-09-22 18:14:50 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 26 00 23
2025-09-22 18:14:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:51 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:14:51 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:14:53 INFO [sicp_service.manager] Setting LED on spare to True #FF2600
2025-09-22 18:14:53 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 26 00 23
2025-09-22 18:14:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:54 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:14:54 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:14:55 INFO [sicp_service.manager] Setting LED on spare to False #FF2600
2025-09-22 18:14:55 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:14:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:56 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #FF2600
2025-09-22 18:14:56 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:14:56 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:14:56 INFO [sicp_service.manager] Setting LED on spare to True #FF2600
2025-09-22 18:14:56 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 26 00 23
2025-09-22 18:14:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:14:57 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:14:57 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:15:01 INFO [sicp_service.manager] Setting LED on spare to True #E63B7A
2025-09-22 18:15:01 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 E6 3B 7A 5D
2025-09-22 18:15:02 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:15:02 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:15:02 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:15:06 INFO [sicp_service.manager] Setting LED on spare to True #E32400
2025-09-22 18:15:06 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 E3 24 00 3D
2025-09-22 18:15:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:15:07 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:15:07 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:15:11 INFO [sicp_service.manager] Setting LED on spare to True #00F900
2025-09-22 18:15:11 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 F9 00 03
2025-09-22 18:15:11 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:15:12 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:15:12 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:15:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:15:14 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:15:16 INFO [sicp_service.manager] Setting LED on spare to True #0433FF
2025-09-22 18:15:16 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 04 33 FF 32
2025-09-22 18:15:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:15:16 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:15:16 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:15:19 INFO [sicp_service.manager] Setting LED on spare to True #FF2600
2025-09-22 18:15:19 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 26 00 23
2025-09-22 18:15:19 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:15:20 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:15:20 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:15:20 INFO [sicp_service.manager] Setting LED on spare to True #FF2600
2025-09-22 18:15:20 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 26 00 23
2025-09-22 18:15:21 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:15:21 INFO [uvicorn.access] 127.0.0.1:56823 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:15:21 INFO [uvicorn.access] 127.0.0.1:56823 - "GET / HTTP/1.1" 200
2025-09-22 18:15:29 INFO [sicp_service.manager] Setting LED on spare to False #FF2600
2025-09-22 18:15:29 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:15:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:15:30 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #FF2600
2025-09-22 18:15:30 INFO [uvicorn.access] 127.0.0.1:56854 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:15:30 INFO [uvicorn.access] 127.0.0.1:56854 - "GET / HTTP/1.1" 200
2025-09-22 18:15:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:15:45 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:16:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:16:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:16:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:16:47 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:17:18 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:17:18 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:17:21 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:17:21 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:17:21 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:17:21 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:17:21 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:21:57 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:21:57 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:21:57 INFO [uvicorn.error] Started server process [13621]
2025-09-22 18:21:57 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:21:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:21:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:21:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:21:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:21:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:21:57 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:21:57 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4489895888
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:21:57 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:21:57 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:21:57 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:21:58 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:21:59 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:22:00 INFO [uvicorn.access] 127.0.0.1:56998 - "GET / HTTP/1.1" 200
2025-09-22 18:22:00 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:22:02 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:22:07 INFO [sicp_service.manager] Setting LED on bathroom to False #000000
2025-09-22 18:22:07 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:22:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:10 WARNING [sicp_service.manager] Communication failure with bathroom: LED verification failed: expected OFF #000000, got OFF #00FF00
2025-09-22 18:22:10 INFO [uvicorn.access] 127.0.0.1:57002 - "POST /api/tablets/bathroom/light HTTP/1.1" 200
2025-09-22 18:22:10 INFO [uvicorn.access] 127.0.0.1:57002 - "GET / HTTP/1.1" 200
2025-09-22 18:22:18 INFO [sicp_service.manager] Setting LED on spare to True #FF0000
2025-09-22 18:22:18 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 18:22:19 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:19 INFO [uvicorn.access] 127.0.0.1:57006 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:22:19 INFO [uvicorn.access] 127.0.0.1:57006 - "GET / HTTP/1.1" 200
2025-09-22 18:22:26 INFO [sicp_service.manager] Setting LED on spare to True #00FF40
2025-09-22 18:22:26 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF 40 45
2025-09-22 18:22:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:27 INFO [uvicorn.access] 127.0.0.1:57014 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:22:27 INFO [uvicorn.access] 127.0.0.1:57014 - "GET / HTTP/1.1" 200
2025-09-22 18:22:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:28 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:22:29 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:22:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:22:30 INFO [sicp_service.manager] Setting LED on spare to True #0080FF
2025-09-22 18:22:30 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 80 FF 85
2025-09-22 18:22:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:31 INFO [uvicorn.access] 127.0.0.1:57014 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:22:31 INFO [uvicorn.access] 127.0.0.1:57014 - "GET / HTTP/1.1" 200
2025-09-22 18:22:31 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:33 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:22:34 INFO [sicp_service.manager] Setting LED on spare to True #B400FF
2025-09-22 18:22:34 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 B4 00 FF B1
2025-09-22 18:22:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:35 INFO [uvicorn.access] 127.0.0.1:57014 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:22:35 INFO [uvicorn.access] 127.0.0.1:57014 - "GET / HTTP/1.1" 200
2025-09-22 18:22:37 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:22:37 INFO [sicp_service.manager] Setting LED on spare to True #FF8000
2025-09-22 18:22:37 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 80 00 85
2025-09-22 18:22:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:38 INFO [uvicorn.access] 127.0.0.1:57014 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:22:38 INFO [uvicorn.access] 127.0.0.1:57014 - "GET / HTTP/1.1" 200
2025-09-22 18:22:41 INFO [sicp_service.manager] Setting LED on spare to True #FFA040
2025-09-22 18:22:41 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF A0 40 E5
2025-09-22 18:22:41 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:41 INFO [uvicorn.access] 127.0.0.1:57014 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:22:41 INFO [uvicorn.access] 127.0.0.1:57014 - "GET / HTTP/1.1" 200
2025-09-22 18:22:43 INFO [sicp_service.manager] Setting LED on spare to True #C8DCFF
2025-09-22 18:22:43 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 C8 DC FF 11
2025-09-22 18:22:43 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:44 INFO [uvicorn.access] 127.0.0.1:57014 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:22:44 INFO [uvicorn.access] 127.0.0.1:57014 - "GET / HTTP/1.1" 200
2025-09-22 18:22:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:22:59 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:23:00 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:23:00 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:23:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:23:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:23:06 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:23:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:23:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:23:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:23:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:23:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:23:31 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:23:31 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:23:32 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:23:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:23:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:23:40 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:23:45 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:24:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:24:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:24:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:24:02 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:24:02 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:24:03 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:24:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:24:11 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:24:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:24:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:24:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:24:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:24:32 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:24:33 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:24:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:24:35 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:24:41 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:24:44 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:24:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:24:48 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:25:02 INFO [uvicorn.access] 127.0.0.1:57094 - "GET / HTTP/1.1" 200
2025-09-22 18:25:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:25:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:25:03 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:25:04 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:25:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:25:06 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:25:09 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:25:09 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:25:09 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:25:09 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:25:09 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:25:09 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:25:09 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:25:09 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:25:09 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:25:37 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:25:37 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:25:37 INFO [uvicorn.error] Started server process [13924]
2025-09-22 18:25:37 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:25:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:25:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:25:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:25:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:25:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:25:37 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:25:37 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4459781424
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:25:37 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:25:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:25:37 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:25:37 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:25:38 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:25:39 INFO [uvicorn.access] 127.0.0.1:57119 - "GET / HTTP/1.1" 200
2025-09-22 18:25:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:25:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:25:59 INFO [sicp_service.manager] Setting LED on spare to True #00FF00
2025-09-22 18:25:59 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 18:25:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:00 INFO [uvicorn.access] 127.0.0.1:57123 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:26:00 INFO [uvicorn.access] 127.0.0.1:57123 - "GET / HTTP/1.1" 200
2025-09-22 18:26:03 INFO [sicp_service.manager] Setting LED on office to False #000000
2025-09-22 18:26:03 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:26:04 INFO [sicp_service.manager] Setting LED on hallway to False #000000
2025-09-22 18:26:04 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:26:04 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:05 WARNING [sicp_service.manager] Communication failure with hallway: LED verification failed: expected OFF #000000, got OFF #FFFFFF
2025-09-22 18:26:05 INFO [uvicorn.access] 127.0.0.1:57127 - "POST /api/tablets/hallway/light HTTP/1.1" 200
2025-09-22 18:26:05 INFO [uvicorn.access] 127.0.0.1:57127 - "GET / HTTP/1.1" 200
2025-09-22 18:26:05 WARNING [sicp_service.manager] Communication failure with office: LED verification failed: expected OFF #000000, got OFF #FFFFFF
2025-09-22 18:26:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:08 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:09 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:09 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:11 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:11 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:12 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:16 INFO [uvicorn.access] 127.0.0.1:57142 - "GET / HTTP/1.1" 200
2025-09-22 18:26:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:39 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:41 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:42 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:43 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:44 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:52 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:26:52 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:26:52 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:26:52 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:26:52 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:26:52 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:26:52 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:26:52 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:26:52 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:26:53 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:26:53 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:26:53 INFO [uvicorn.error] Started server process [14099]
2025-09-22 18:26:53 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:26:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:26:53 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:26:53 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4487011632
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:26:53 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:26:53 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:26:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:54 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:54 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:26:55 INFO [uvicorn.access] 127.0.0.1:57171 - "GET / HTTP/1.1" 200
2025-09-22 18:26:58 INFO [sicp_service.manager] Setting LED on spare to True #FF0000
2025-09-22 18:26:58 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 18:26:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:26:59 INFO [uvicorn.access] 127.0.0.1:57171 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:26:59 INFO [uvicorn.access] 127.0.0.1:57171 - "GET / HTTP/1.1" 200
2025-09-22 18:27:00 INFO [sicp_service.manager] Setting LED on spare to True #00FFFF
2025-09-22 18:27:00 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF FF FA
2025-09-22 18:27:00 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:00 INFO [uvicorn.access] 127.0.0.1:57171 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:01 INFO [uvicorn.access] 127.0.0.1:57171 - "GET / HTTP/1.1" 200
2025-09-22 18:27:01 INFO [sicp_service.manager] Setting LED on spare to True #0000FF
2025-09-22 18:27:01 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 18:27:02 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:02 INFO [uvicorn.access] 127.0.0.1:57171 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:02 INFO [uvicorn.access] 127.0.0.1:57171 - "GET / HTTP/1.1" 200
2025-09-22 18:27:03 INFO [sicp_service.manager] Setting LED on spare to True #FF00FF
2025-09-22 18:27:03 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 18:27:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:04 INFO [uvicorn.access] 127.0.0.1:57171 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:04 INFO [sicp_service.manager] Setting LED on spare to True #FFFF00
2025-09-22 18:27:04 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF FF 00 FA
2025-09-22 18:27:04 INFO [uvicorn.access] 127.0.0.1:57171 - "GET / HTTP/1.1" 200
2025-09-22 18:27:04 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:05 INFO [sicp_service.manager] Setting LED on spare to True #FFFFFF
2025-09-22 18:27:05 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF FF FF 05
2025-09-22 18:27:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:06 INFO [uvicorn.access] 127.0.0.1:57171 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:06 INFO [uvicorn.access] 127.0.0.1:57171 - "GET / HTTP/1.1" 200
2025-09-22 18:27:07 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 18:27:07 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:27:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:08 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #FFFFFF
2025-09-22 18:27:08 INFO [uvicorn.access] 127.0.0.1:57171 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:08 INFO [uvicorn.access] 127.0.0.1:57171 - "GET / HTTP/1.1" 200
2025-09-22 18:27:11 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 18:27:11 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:27:12 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:12 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #FFFFFF
2025-09-22 18:27:12 INFO [uvicorn.access] 127.0.0.1:57171 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:12 INFO [uvicorn.access] 127.0.0.1:57171 - "GET / HTTP/1.1" 200
2025-09-22 18:27:20 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 18:27:20 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:27:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:21 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #FFFFFF
2025-09-22 18:27:21 INFO [uvicorn.access] 127.0.0.1:57191 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:21 INFO [uvicorn.access] 127.0.0.1:57191 - "GET / HTTP/1.1" 200
2025-09-22 18:27:24 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:24 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:24 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:24 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:24 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:27:24 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:25 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:27:25 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:27:25 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:27:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:27:37 INFO [sicp_service.manager] Setting LED on spare to True #00FF00
2025-09-22 18:27:37 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 18:27:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:38 INFO [uvicorn.access] 127.0.0.1:57210 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:38 INFO [uvicorn.access] 127.0.0.1:57210 - "GET / HTTP/1.1" 200
2025-09-22 18:27:38 INFO [sicp_service.manager] Setting LED on spare to True #FF0000
2025-09-22 18:27:38 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 18:27:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:39 INFO [uvicorn.access] 127.0.0.1:57210 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:39 INFO [uvicorn.access] 127.0.0.1:57210 - "GET / HTTP/1.1" 200
2025-09-22 18:27:41 INFO [sicp_service.manager] Setting LED on spare to True #00FF00
2025-09-22 18:27:41 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 18:27:42 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:42 INFO [uvicorn.access] 127.0.0.1:57210 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:42 INFO [uvicorn.access] 127.0.0.1:57210 - "GET / HTTP/1.1" 200
2025-09-22 18:27:43 INFO [sicp_service.manager] Setting LED on spare to True #0000FF
2025-09-22 18:27:43 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 18:27:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:44 INFO [uvicorn.access] 127.0.0.1:57210 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:44 INFO [uvicorn.access] 127.0.0.1:57210 - "GET / HTTP/1.1" 200
2025-09-22 18:27:46 INFO [sicp_service.manager] Setting LED on spare to True #00FFFF
2025-09-22 18:27:46 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF FF FA
2025-09-22 18:27:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:47 INFO [uvicorn.access] 127.0.0.1:57210 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:47 INFO [uvicorn.access] 127.0.0.1:57210 - "GET / HTTP/1.1" 200
2025-09-22 18:27:49 INFO [sicp_service.manager] Setting LED on spare to True #FF00FF
2025-09-22 18:27:49 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 18:27:49 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:50 INFO [uvicorn.access] 127.0.0.1:57210 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:50 INFO [uvicorn.access] 127.0.0.1:57210 - "GET / HTTP/1.1" 200
2025-09-22 18:27:51 INFO [sicp_service.manager] Setting LED on spare to True #FFFFFF
2025-09-22 18:27:51 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF FF FF 05
2025-09-22 18:27:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:52 INFO [uvicorn.access] 127.0.0.1:57210 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:52 INFO [uvicorn.access] 127.0.0.1:57210 - "GET / HTTP/1.1" 200
2025-09-22 18:27:53 INFO [sicp_service.manager] Setting LED on spare to True #FF0000
2025-09-22 18:27:53 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 18:27:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:54 INFO [uvicorn.access] 127.0.0.1:57210 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:54 INFO [uvicorn.access] 127.0.0.1:57210 - "GET / HTTP/1.1" 200
2025-09-22 18:27:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:55 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 18:27:55 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:27:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:55 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:27:56 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #FF0000
2025-09-22 18:27:56 INFO [uvicorn.access] 127.0.0.1:57210 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:27:56 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:56 INFO [uvicorn.access] 127.0.0.1:57210 - "GET / HTTP/1.1" 200
2025-09-22 18:27:56 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:27:56 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:56 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:27:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:27:58 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:27:59 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:28:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:28:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:27 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:28:27 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:27 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:28:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:28:30 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:28:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:28:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:28:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:28:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:28:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:28:30 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:28:30 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:28:30 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:28:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:31 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:57 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:28:57 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:28:57 INFO [uvicorn.error] Started server process [14291]
2025-09-22 18:28:57 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:28:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:28:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:28:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:28:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:28:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:28:57 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:28:57 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4486225200
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:28:57 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:28:57 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:28:57 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:57 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:57 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:58 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:58 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:28:59 INFO [uvicorn.access] 127.0.0.1:57267 - "GET / HTTP/1.1" 200
2025-09-22 18:29:02 INFO [sicp_service.manager] Setting power on spare to False
2025-09-22 18:29:02 INFO [sicp_service.sicp] SICP SET_POWER -> 192.168.2.71:5000 (expect reply): 06 01 00 19 01 1F
2025-09-22 18:29:02 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:03 INFO [uvicorn.access] 127.0.0.1:57267 - "POST /api/tablets/spare/power HTTP/1.1" 200
2025-09-22 18:29:03 INFO [uvicorn.access] 127.0.0.1:57267 - "GET / HTTP/1.1" 200
2025-09-22 18:29:10 INFO [sicp_service.manager] Setting power on spare to False
2025-09-22 18:29:10 INFO [sicp_service.sicp] SICP SET_POWER -> 192.168.2.71:5000 (expect reply): 06 01 00 19 01 1F
2025-09-22 18:29:11 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:11 INFO [uvicorn.access] 127.0.0.1:57273 - "POST /api/tablets/spare/power HTTP/1.1" 200
2025-09-22 18:29:11 INFO [uvicorn.access] 127.0.0.1:57273 - "GET / HTTP/1.1" 200
2025-09-22 18:29:21 INFO [sicp_service.manager] Setting power on spare to False
2025-09-22 18:29:21 INFO [sicp_service.sicp] SICP SET_POWER -> 192.168.2.71:5000 (expect reply): 06 01 00 19 01 1F
2025-09-22 18:29:21 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:22 INFO [uvicorn.access] 127.0.0.1:57277 - "POST /api/tablets/spare/power HTTP/1.1" 200
2025-09-22 18:29:22 INFO [uvicorn.access] 127.0.0.1:57277 - "GET / HTTP/1.1" 200
2025-09-22 18:29:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:28 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:28 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:29 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:31 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:48 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:29:48 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:29:48 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:29:48 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:29:48 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:29:48 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:29:48 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:29:48 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:29:48 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:29:52 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:29:52 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:29:52 INFO [uvicorn.error] Started server process [14481]
2025-09-22 18:29:52 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:29:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:29:52 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:29:52 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4416068912
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:29:52 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:29:52 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:29:52 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:52 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:52 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:52 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:53 INFO [uvicorn.access] 127.0.0.1:57309 - "GET / HTTP/1.1" 200
2025-09-22 18:29:55 INFO [sicp_service.manager] Setting LED on spare to True #FF0000
2025-09-22 18:29:55 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 18:29:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:55 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:29:56 INFO [uvicorn.access] 127.0.0.1:57309 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:29:56 INFO [uvicorn.access] 127.0.0.1:57309 - "GET / HTTP/1.1" 200
2025-09-22 18:29:57 INFO [sicp_service.manager] Setting LED on spare to True #00FF00
2025-09-22 18:29:57 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 18:29:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:29:58 INFO [uvicorn.access] 127.0.0.1:57309 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:29:58 INFO [uvicorn.access] 127.0.0.1:57309 - "GET / HTTP/1.1" 200
2025-09-22 18:29:59 INFO [sicp_service.manager] Setting LED on spare to True #0000FF
2025-09-22 18:29:59 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 18:29:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:00 INFO [uvicorn.access] 127.0.0.1:57309 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:30:00 INFO [uvicorn.access] 127.0.0.1:57309 - "GET / HTTP/1.1" 200
2025-09-22 18:30:01 INFO [sicp_service.manager] Setting LED on spare to True #FFFFFF
2025-09-22 18:30:01 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF FF FF 05
2025-09-22 18:30:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:02 INFO [uvicorn.access] 127.0.0.1:57309 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:30:02 INFO [uvicorn.access] 127.0.0.1:57309 - "GET / HTTP/1.1" 200
2025-09-22 18:30:02 INFO [sicp_service.manager] Setting LED on spare to True #FF00FF
2025-09-22 18:30:02 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 18:30:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:03 INFO [uvicorn.access] 127.0.0.1:57309 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:30:03 INFO [uvicorn.access] 127.0.0.1:57309 - "GET / HTTP/1.1" 200
2025-09-22 18:30:03 INFO [sicp_service.manager] Setting LED on spare to True #FFFF00
2025-09-22 18:30:03 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF FF 00 FA
2025-09-22 18:30:04 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:04 INFO [uvicorn.access] 127.0.0.1:57309 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:30:04 INFO [uvicorn.access] 127.0.0.1:57309 - "GET / HTTP/1.1" 200
2025-09-22 18:30:06 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 18:30:06 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:30:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:06 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #FFFF00
2025-09-22 18:30:06 INFO [uvicorn.access] 127.0.0.1:57309 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:30:06 INFO [uvicorn.access] 127.0.0.1:57309 - "GET / HTTP/1.1" 200
2025-09-22 18:30:09 INFO [sicp_service.manager] Setting power on spare to False
2025-09-22 18:30:09 INFO [sicp_service.sicp] SICP SET_POWER -> 192.168.2.71:5000 (expect reply): 06 01 00 19 01 1F
2025-09-22 18:30:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:30:10 INFO [uvicorn.access] 127.0.0.1:57309 - "POST /api/tablets/spare/power HTTP/1.1" 200
2025-09-22 18:30:10 INFO [uvicorn.access] 127.0.0.1:57309 - "GET / HTTP/1.1" 200
2025-09-22 18:30:22 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:23 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:23 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:23 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:30:23 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:23 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:30:23 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:30:23 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:30:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:28 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:30:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:54 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:30:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:30:54 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:30:54 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:30:56 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:30:58 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:00 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:31:24 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:25 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:25 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:25 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:31:25 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:31:25 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:31:27 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:31 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:31:31 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:34 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:31:49 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:31:49 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:31:49 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:31:49 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:31:49 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:31:49 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:31:49 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:31:49 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:31:49 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:31:50 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:31:50 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:31:50 INFO [uvicorn.error] Started server process [14740]
2025-09-22 18:31:50 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:31:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:31:50 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:31:50 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4483473696
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:31:50 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:31:50 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:31:50 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:31:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:31:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:31:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:31:52 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:08 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:32:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:32:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:32:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:32:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:32:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:32:08 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:32:08 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:32:08 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:32:09 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:32:09 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:32:09 INFO [uvicorn.error] Started server process [14855]
2025-09-22 18:32:09 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:32:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:32:09 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:32:09 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4458978944
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:32:09 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:32:09 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:32:09 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:09 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:09 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:14 INFO [sicp_service.manager] Setting power on spare to False
2025-09-22 18:32:14 INFO [sicp_service.sicp] SICP SET_POWER -> 192.168.2.71:5000 (expect reply): 06 01 00 19 01 1F
2025-09-22 18:32:19 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:20 INFO [uvicorn.access] 127.0.0.1:57413 - "POST /api/tablets/spare/power HTTP/1.1" 200
2025-09-22 18:32:20 INFO [uvicorn.access] 127.0.0.1:57413 - "GET / HTTP/1.1" 200
2025-09-22 18:32:21 INFO [sicp_service.manager] Setting LED on spare to True #FFFF00
2025-09-22 18:32:21 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF FF 00 FA
2025-09-22 18:32:27 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:27 INFO [uvicorn.access] 127.0.0.1:57413 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:32:27 INFO [sicp_service.manager] Setting LED on spare to True #FF00FF
2025-09-22 18:32:27 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 18:32:27 INFO [uvicorn.access] 127.0.0.1:57413 - "GET / HTTP/1.1" 200
2025-09-22 18:32:33 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:33 INFO [sicp_service.manager] Setting LED on spare to True #00FFFF
2025-09-22 18:32:33 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF FF FA
2025-09-22 18:32:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:39 INFO [uvicorn.access] 127.0.0.1:57413 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:32:39 INFO [sicp_service.manager] Setting LED on spare to True #0000FF
2025-09-22 18:32:39 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 18:32:39 INFO [uvicorn.access] 127.0.0.1:57413 - "GET / HTTP/1.1" 200
2025-09-22 18:32:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:40 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:40 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:41 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:42 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:42 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:32:42 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:32:42 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:32:42 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:32:42 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:32:42 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:32:42 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:32:42 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:32:42 ERROR [uvicorn.error] Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/web.py", line 72, in set_light
    state = await tablets.set_light(
            ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/manager.py", line 316, in set_light
    return await controller.set_light(on=on, red=red, green=green, blue=blue)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/manager.py", line 105, in set_light
    await asyncio.sleep(self.polling.verification_delay_seconds)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError
2025-09-22 18:32:42 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:32:43 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:32:43 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:32:43 INFO [uvicorn.error] Started server process [15000]
2025-09-22 18:32:43 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:32:43 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:43 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:43 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:43 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:43 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:32:43 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:32:43 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4479065728
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:32:43 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:32:43 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:32:43 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:43 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:43 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:43 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:44 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:47 INFO [sicp_service.manager] Setting LED on spare to True #FF0000
2025-09-22 18:32:47 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 18:32:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:48 INFO [uvicorn.access] 127.0.0.1:57461 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:32:48 INFO [uvicorn.access] 127.0.0.1:57461 - "GET / HTTP/1.1" 200
2025-09-22 18:32:50 INFO [sicp_service.manager] Setting LED on spare to True #00FF00
2025-09-22 18:32:50 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 18:32:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:51 INFO [uvicorn.access] 127.0.0.1:57461 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:32:51 INFO [uvicorn.access] 127.0.0.1:57461 - "GET / HTTP/1.1" 200
2025-09-22 18:32:52 INFO [sicp_service.manager] Setting LED on spare to True #0000FF
2025-09-22 18:32:52 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 18:32:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:32:54 INFO [uvicorn.access] 127.0.0.1:57461 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:32:54 INFO [uvicorn.access] 127.0.0.1:57461 - "GET / HTTP/1.1" 200
2025-09-22 18:32:55 INFO [sicp_service.manager] Setting power on spare to False
2025-09-22 18:32:55 INFO [sicp_service.sicp] SICP SET_POWER -> 192.168.2.71:5000 (expect reply): 06 01 00 19 01 1F
2025-09-22 18:32:56 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:32:56 INFO [uvicorn.access] 127.0.0.1:57461 - "POST /api/tablets/spare/power HTTP/1.1" 200
2025-09-22 18:32:56 INFO [uvicorn.access] 127.0.0.1:57461 - "GET / HTTP/1.1" 200
2025-09-22 18:33:00 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 18:33:00 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:33:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:01 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #0000FF
2025-09-22 18:33:01 INFO [uvicorn.access] 127.0.0.1:57461 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:33:01 INFO [uvicorn.access] 127.0.0.1:57461 - "GET / HTTP/1.1" 200
2025-09-22 18:33:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:14 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:14 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:14 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:17 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:19 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 18:33:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:43 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"ON"}
2025-09-22 18:33:43 INFO [sicp_service.manager] Setting LED on spare to True #0000FF
2025-09-22 18:33:43 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 18:33:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:45 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:45 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:45 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:46 INFO [sicp_service.mqtt] MQTT light command for spare: {"state":"OFF"}
2025-09-22 18:33:46 INFO [sicp_service.manager] Setting LED on spare to True #0000FF
2025-09-22 18:33:46 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 18:33:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:50 INFO [sicp_service.mqtt] MQTT power command for spare: OFF
2025-09-22 18:33:50 INFO [sicp_service.manager] Setting power on spare to False
2025-09-22 18:33:50 INFO [sicp_service.sicp] SICP SET_POWER -> 192.168.2.71:5000 (expect reply): 06 01 00 19 01 1F
2025-09-22 18:33:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:33:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:55 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:33:58 INFO [sicp_service.mqtt] MQTT power command for spare: ON
2025-09-22 18:33:58 INFO [sicp_service.manager] Setting power on spare to True
2025-09-22 18:33:58 INFO [sicp_service.sicp] SICP SET_POWER -> 192.168.2.71:5000 (expect reply): 06 01 00 19 02 1C
2025-09-22 18:33:58 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:34:13 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:34:13 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:34:13 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:34:13 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:34:13 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:34:13 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:34:13 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:34:13 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:34:13 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:34:14 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:34:14 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:34:14 INFO [uvicorn.error] Started server process [15164]
2025-09-22 18:34:14 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:34:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:34:14 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:34:14 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4449542432
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:34:14 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:34:14 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:34:14 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:34:14 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:34:14 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:34:15 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:34:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:34:18 INFO [uvicorn.access] 127.0.0.1:57528 - "GET / HTTP/1.1" 200
2025-09-22 18:34:21 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 18:34:21 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:34:22 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:22 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #0000FF
2025-09-22 18:34:22 INFO [uvicorn.access] 127.0.0.1:57528 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:34:22 INFO [uvicorn.access] 127.0.0.1:57528 - "GET / HTTP/1.1" 200
2025-09-22 18:34:26 INFO [sicp_service.manager] Setting LED on spare to True #00FFFF
2025-09-22 18:34:26 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF FF FA
2025-09-22 18:34:27 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:27 INFO [uvicorn.access] 127.0.0.1:57528 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:34:27 INFO [uvicorn.access] 127.0.0.1:57528 - "GET / HTTP/1.1" 200
2025-09-22 18:34:30 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 18:34:30 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:34:31 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:31 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #00FFFF
2025-09-22 18:34:31 INFO [uvicorn.access] 127.0.0.1:57528 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:34:31 INFO [uvicorn.access] 127.0.0.1:57528 - "GET / HTTP/1.1" 200
2025-09-22 18:34:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:45 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:34:45 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:34:45 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:34:46 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:34:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:34:49 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:35:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:35:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:35:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:35:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:19 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:35:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:21 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:35:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:47 INFO [sicp_service.manager] Setting LED on office to True #FF0000
2025-09-22 18:35:47 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 18:35:47 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:35:47 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:35:47 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:35:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:52 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:35:56 INFO [uvicorn.access] 127.0.0.1:57586 - "POST /api/tablets/office/light HTTP/1.1" 200
2025-09-22 18:35:56 INFO [sicp_service.manager] Setting LED on office to True #00FF00
2025-09-22 18:35:56 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 18:35:56 INFO [uvicorn.access] 127.0.0.1:57586 - "GET / HTTP/1.1" 200
2025-09-22 18:35:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:35:59 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:36:00 INFO [sicp_service.manager] Setting LED on office to True #00FF00
2025-09-22 18:36:00 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 18:36:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:36:01 INFO [uvicorn.access] 127.0.0.1:57586 - "POST /api/tablets/office/light HTTP/1.1" 200
2025-09-22 18:36:01 INFO [uvicorn.access] 127.0.0.1:57586 - "GET / HTTP/1.1" 200
2025-09-22 18:36:03 INFO [sicp_service.manager] Setting LED on office to True #0000FF
2025-09-22 18:36:03 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 18:36:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:36:07 INFO [uvicorn.access] 127.0.0.1:57586 - "POST /api/tablets/office/light HTTP/1.1" 200
2025-09-22 18:36:07 INFO [uvicorn.access] 127.0.0.1:57586 - "GET / HTTP/1.1" 200
2025-09-22 18:36:18 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:36:18 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:36:18 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:36:18 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:36:18 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:36:19 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:36:23 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:36:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:36:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:36:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:36:49 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:36:49 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:36:49 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:36:49 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:36:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:36:50 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:36:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:37:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:37:04 INFO [sicp_service.manager] Setting LED on office to True #FF00FF
2025-09-22 18:37:04 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 18:37:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:06 INFO [uvicorn.access] 127.0.0.1:57631 - "POST /api/tablets/office/light HTTP/1.1" 200
2025-09-22 18:37:06 INFO [uvicorn.access] 127.0.0.1:57631 - "GET / HTTP/1.1" 200
2025-09-22 18:37:11 INFO [sicp_service.manager] Setting LED on office to False #000000
2025-09-22 18:37:11 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:37:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:19 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 18:37:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:20 WARNING [sicp_service.manager] Communication failure with office: LED verification failed: expected OFF #000000, got OFF #FF00FF
2025-09-22 18:37:20 INFO [uvicorn.access] 127.0.0.1:57635 - "POST /api/tablets/office/light HTTP/1.1" 200
2025-09-22 18:37:20 INFO [uvicorn.access] 127.0.0.1:57635 - "GET / HTTP/1.1" 200
2025-09-22 18:37:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:37:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:37:21 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:21 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:37:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:35 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:37:35 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:37:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:37:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:37:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:37:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:06 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:06 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:06 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:38:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:38:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:38:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:38:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:38:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:38:07 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:38:07 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:38:07 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:38:08 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:38:08 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:38:08 INFO [uvicorn.error] Started server process [15490]
2025-09-22 18:38:08 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:38:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:38:08 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:38:08 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4490748192
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:38:08 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:38:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:38:08 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:08 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:08 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:08 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:09 INFO [uvicorn.access] 127.0.0.1:57673 - "GET / HTTP/1.1" 500
2025-09-22 18:38:09 ERROR [uvicorn.error] Exception in ASGI application
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/web.py", line 189, in index
    body: JSON.stringify({ state: 'ON' }),
                         ^^^^^^^^^^^^^^^
TypeError: unsupported format string passed to TabletState.__format__
2025-09-22 18:38:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:11 INFO [uvicorn.access] 127.0.0.1:57678 - "GET / HTTP/1.1" 500
2025-09-22 18:38:11 ERROR [uvicorn.error] Exception in ASGI application
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/web.py", line 189, in index
    body: JSON.stringify({ state: 'ON' }),
                         ^^^^^^^^^^^^^^^
TypeError: unsupported format string passed to TabletState.__format__
2025-09-22 18:38:13 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:38:13 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:38:13 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:38:13 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:38:13 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:38:13 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:38:13 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:38:13 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:38:13 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:38:14 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:38:14 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:38:14 INFO [uvicorn.error] Started server process [15612]
2025-09-22 18:38:14 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:38:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:38:14 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:38:14 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4484865328
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:38:14 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:38:14 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:38:15 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:15 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:15 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:15 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:15 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:17 INFO [uvicorn.access] 127.0.0.1:57693 - "GET / HTTP/1.1" 500
2025-09-22 18:38:17 ERROR [uvicorn.error] Exception in ASGI application
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/web.py", line 189, in index
    body: JSON.stringify({ state: 'ON' }),
                         ^^^^^^^^^^^^^^^
TypeError: unsupported format string passed to TabletState.__format__
2025-09-22 18:38:18 INFO [uvicorn.access] 127.0.0.1:57695 - "GET / HTTP/1.1" 500
2025-09-22 18:38:18 ERROR [uvicorn.error] Exception in ASGI application
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/web.py", line 189, in index
    body: JSON.stringify({ state: 'ON' }),
                         ^^^^^^^^^^^^^^^
TypeError: unsupported format string passed to TabletState.__format__
2025-09-22 18:38:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:46 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:38:46 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:46 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:46 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:38:50 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:39:07 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:39:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:39:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:39:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:39:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:39:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:39:07 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:39:07 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:39:07 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:39:08 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:39:08 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:39:08 INFO [uvicorn.error] Started server process [15778]
2025-09-22 18:39:08 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:39:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:39:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:39:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:39:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:39:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:39:08 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:39:08 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4489174320
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:39:08 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:39:08 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:39:08 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:39:08 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:39:08 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:39:08 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:39:09 INFO [uvicorn.access] 127.0.0.1:57724 - "GET / HTTP/1.1" 500
2025-09-22 18:39:09 ERROR [uvicorn.error] Exception in ASGI application
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/web.py", line 189, in index
    body: JSON.stringify({"state": "ON"}),
                         ^^^^^^^^^^^^^^^
ValueError: Invalid format specifier ' "ON"' for object of type 'str'
2025-09-22 18:39:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:39:10 INFO [uvicorn.access] 127.0.0.1:57729 - "GET / HTTP/1.1" 500
2025-09-22 18:39:10 ERROR [uvicorn.error] Exception in ASGI application
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/web.py", line 189, in index
    body: JSON.stringify({"state": "ON"}),
                         ^^^^^^^^^^^^^^^
ValueError: Invalid format specifier ' "ON"' for object of type 'str'
2025-09-22 18:39:38 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:39:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:39:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:39:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:39:39 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:39:39 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:39:39 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:39:39 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:39:41 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:39:42 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:40:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:40:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:40:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:40:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:11 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:12 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:40:13 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:24 INFO [uvicorn.access] 127.0.0.1:57757 - "GET / HTTP/1.1" 500
2025-09-22 18:40:24 ERROR [uvicorn.error] Exception in ASGI application
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/web.py", line 189, in index
    body: JSON.stringify({"state": "ON"}),
                         ^^^^^^^^^^^^^^^
ValueError: Invalid format specifier ' "ON"' for object of type 'str'
2025-09-22 18:40:28 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:40:28 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:40:28 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:40:28 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:40:28 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:40:28 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:40:28 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:40:28 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:40:28 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:40:30 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:40:30 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:40:30 INFO [uvicorn.error] Started server process [15993]
2025-09-22 18:40:30 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:40:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:40:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:40:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:40:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:40:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:40:30 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:40:30 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4488748336
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:40:30 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:40:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:40:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:31 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:40:32 INFO [uvicorn.access] 127.0.0.1:57773 - "GET / HTTP/1.1" 500
2025-09-22 18:40:32 ERROR [uvicorn.error] Exception in ASGI application
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/web.py", line 189, in index
    body: JSON.stringify({"state": "ON"}),
                         ^^^^^^^^^^^^^^^
ValueError: Invalid format specifier ' "ON"' for object of type 'str'
2025-09-22 18:40:37 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:40:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:40:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:40:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:40:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:40:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:40:37 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:40:37 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:40:37 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:42:15 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:42:15 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:42:15 INFO [uvicorn.error] Started server process [16228]
2025-09-22 18:42:15 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:42:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:42:15 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:42:15 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4446723376
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:42:15 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:42:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:42:15 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:42:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:42:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:42:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:42:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:42:17 INFO [uvicorn.access] 127.0.0.1:57797 - "GET / HTTP/1.1" 200
2025-09-22 18:42:25 INFO [sicp_service.manager] Setting LED on spare to True #FFFF00
2025-09-22 18:42:25 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF FF 00 FA
2025-09-22 18:42:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:27 INFO [uvicorn.access] 127.0.0.1:57801 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:42:27 INFO [uvicorn.access] 127.0.0.1:57801 - "GET / HTTP/1.1" 200
2025-09-22 18:42:30 INFO [sicp_service.manager] Setting LED on spare to True #FF00FF
2025-09-22 18:42:30 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 18:42:31 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:32 INFO [uvicorn.access] 127.0.0.1:57801 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:42:32 INFO [uvicorn.access] 127.0.0.1:57801 - "GET / HTTP/1.1" 200
2025-09-22 18:42:33 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 18:42:33 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:42:35 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:35 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #FF00FF
2025-09-22 18:42:35 INFO [uvicorn.access] 127.0.0.1:57801 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:42:35 INFO [uvicorn.access] 127.0.0.1:57801 - "GET / HTTP/1.1" 200
2025-09-22 18:42:45 INFO [sicp_service.manager] Setting LED on spare to True #FF0000
2025-09-22 18:42:45 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 18:42:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:46 INFO [uvicorn.access] 127.0.0.1:57813 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:42:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:46 INFO [uvicorn.access] 127.0.0.1:57813 - "GET / HTTP/1.1" 200
2025-09-22 18:42:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:47 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:42:47 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:42:47 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:42:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:48 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:42:50 INFO [sicp_service.manager] Setting LED on spare to True #00FF00
2025-09-22 18:42:50 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 18:42:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:42:52 INFO [uvicorn.access] 127.0.0.1:57813 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:42:52 INFO [uvicorn.access] 127.0.0.1:57813 - "GET / HTTP/1.1" 200
2025-09-22 18:42:52 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 18:42:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:42:59 INFO [sicp_service.manager] Setting LED on spare to True #0000FF
2025-09-22 18:42:59 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 18:43:00 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:00 INFO [uvicorn.access] 127.0.0.1:57830 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:43:00 INFO [uvicorn.access] 127.0.0.1:57830 - "GET / HTTP/1.1" 200
2025-09-22 18:43:05 INFO [sicp_service.manager] Setting LED on spare to True #00FFFF
2025-09-22 18:43:05 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 01 00 FF FF FA
2025-09-22 18:43:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:07 INFO [uvicorn.access] 127.0.0.1:57834 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:43:07 INFO [uvicorn.access] 127.0.0.1:57834 - "GET / HTTP/1.1" 200
2025-09-22 18:43:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:18 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:43:18 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:43:18 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:43:18 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:19 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:43:24 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:43:48 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:48 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:48 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:49 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:43:49 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:43:49 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:43:49 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:50 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:43:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:43:57 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:44:02 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:44:02 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:44:02 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:44:02 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:44:02 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:44:02 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:44:02 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:44:02 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:44:02 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:44:37 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:44:37 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:44:37 INFO [uvicorn.error] Started server process [16504]
2025-09-22 18:44:37 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:44:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:44:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:44:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:44:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:44:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:44:37 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:44:37 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4417298720
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:44:37 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:44:37 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:44:37 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:44:38 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:44:38 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:44:38 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:44:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:44:44 INFO [uvicorn.access] 127.0.0.1:57885 - "GET / HTTP/1.1" 200
2025-09-22 18:44:49 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:44:49 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:44:49 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:44:49 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:44:49 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:44:49 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:44:49 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:44:49 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:44:49 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:44:50 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:44:50 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:44:50 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:44:50 INFO [uvicorn.error] Started server process [16644]
2025-09-22 18:44:50 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:44:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:44:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:44:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:44:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:44:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:44:50 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:44:50 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:44:50 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:44:50 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4455619888
2025-09-22 18:44:50 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:44:50 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:44:50 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:44:50 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:44:50 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:44:50 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:44:51 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:44:51 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:44:51 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:44:51 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:44:51 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:44:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:44:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:44:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:44:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:44:52 INFO [uvicorn.access] 127.0.0.1:57900 - "GET / HTTP/1.1" 200
2025-09-22 18:44:52 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:45:03 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 18:45:03 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 18:45:03 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 18:45:03 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 18:45:03 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 18:45:03 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 18:45:03 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 18:45:03 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 18:45:03 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 18:47:20 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 18:47:20 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 18:47:20 INFO [uvicorn.error] Started server process [16881]
2025-09-22 18:47:20 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 18:47:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 18:47:20 INFO [uvicorn.error] Application startup complete.
2025-09-22 18:47:20 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4446969136
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 18:47:20 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 18:47:20 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 18:47:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:47:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:47:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:47:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:47:21 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:47:21 INFO [uvicorn.access] 127.0.0.1:57930 - "GET / HTTP/1.1" 200
2025-09-22 18:47:23 INFO [uvicorn.access] 127.0.0.1:57930 - "GET / HTTP/1.1" 200
2025-09-22 18:47:26 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 18:47:26 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:47:27 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:28 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #00FFFF
2025-09-22 18:47:28 INFO [uvicorn.access] 127.0.0.1:57930 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 18:47:28 INFO [uvicorn.access] 127.0.0.1:57930 - "GET / HTTP/1.1" 200
2025-09-22 18:47:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:47:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:47:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:47:52 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:47:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:47:55 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:48:05 INFO [sicp_service.manager] Setting LED on office to True #00FFFF
2025-09-22 18:48:05 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 01 00 FF FF FA
2025-09-22 18:48:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:11 INFO [uvicorn.access] 127.0.0.1:57970 - "POST /api/tablets/office/light HTTP/1.1" 200
2025-09-22 18:48:11 INFO [sicp_service.manager] Setting LED on office to False #000000
2025-09-22 18:48:11 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:48:11 INFO [uvicorn.access] 127.0.0.1:57970 - "GET / HTTP/1.1" 200
2025-09-22 18:48:12 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:13 WARNING [sicp_service.manager] Communication failure with office: LED verification failed: expected OFF #000000, got OFF #00FFFF
2025-09-22 18:48:13 INFO [sicp_service.manager] Setting LED on office to False #000000
2025-09-22 18:48:13 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 18:48:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:19 WARNING [sicp_service.manager] Communication failure with office: LED verification failed: expected OFF #000000, got OFF #00FFFF
2025-09-22 18:48:19 INFO [uvicorn.access] 127.0.0.1:57970 - "POST /api/tablets/office/light HTTP/1.1" 200
2025-09-22 18:48:19 INFO [uvicorn.access] 127.0.0.1:57970 - "GET / HTTP/1.1" 200
2025-09-22 18:48:22 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:22 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:22 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:22 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:48:22 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:48:22 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:48:24 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:25 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:48:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:48:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:48:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:48:54 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:48:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:48:56 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:48:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:49:00 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:49:24 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:49:24 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:49:24 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:49:24 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:49:25 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:49:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:49:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:49:29 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:49:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:49:31 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:49:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:49:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:49:55 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:49:55 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:49:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:49:57 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:49:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:50:00 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:50:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:50:02 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:50:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:50:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:50:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:50:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:50:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:50:28 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:50:31 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:50:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:50:34 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:50:35 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:50:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:50:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:50:57 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:50:57 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:50:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:50:59 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:51:04 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:51:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:51:06 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:51:07 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:51:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:51:28 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:51:28 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:51:28 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:51:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:51:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:51:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:51:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:51:39 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:51:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:51:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:51:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:51:59 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:51:59 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:52:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:52:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:52:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:52:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:52:11 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:52:13 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:52:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:52:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:52:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:52:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:52:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:52:32 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:52:41 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:52:41 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:52:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:52:46 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:53:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:53:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:53:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:53:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:53:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:53:03 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:53:12 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:53:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:53:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:53:17 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:53:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:53:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:53:32 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:53:32 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:53:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:53:34 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:53:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:53:47 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:53:48 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:53:49 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:54:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:54:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:54:03 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:54:03 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:54:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:54:05 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:54:18 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:54:18 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:54:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:54:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:54:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:54:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:54:34 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:54:34 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:54:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:54:36 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:54:49 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:54:50 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:54:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:54:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:55:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:55:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:55:05 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:55:05 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:55:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:55:07 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:55:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:55:21 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:55:23 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:55:25 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:55:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:55:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:55:36 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:55:36 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:55:38 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:55:38 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:55:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:55:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:55:56 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:56:00 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:56:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:56:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:56:07 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:56:07 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:56:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:56:09 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:56:27 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:56:29 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:56:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:56:33 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:56:38 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:56:38 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:56:38 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:56:38 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:56:40 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:56:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:56:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:57:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:57:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:57:05 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:57:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:57:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:57:09 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:57:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:57:11 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:57:11 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:57:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:57:33 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:57:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:57:36 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:57:40 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:57:40 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:57:40 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:57:41 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:57:42 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:57:42 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:58:04 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:58:06 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:58:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:58:07 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:58:11 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:58:11 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:58:11 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:58:12 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:58:13 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:58:13 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:58:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:58:38 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:58:38 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:58:38 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:58:42 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:58:42 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:58:42 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:58:43 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:58:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:58:44 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:59:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:59:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:59:09 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:59:11 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:59:13 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:59:13 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:59:13 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:59:14 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:59:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:59:15 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:59:40 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:59:41 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:59:41 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:59:43 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:59:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:59:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:59:44 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:59:45 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 18:59:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 18:59:46 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:00:12 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:13 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:14 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:00:14 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:00:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:15 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:00:16 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:00:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:17 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:00:33 INFO [sicp_service.manager] Setting LED on guest to True #0000FF
2025-09-22 19:00:33 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 19:00:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:35 INFO [uvicorn.access] 127.0.0.1:58272 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:00:35 INFO [uvicorn.access] 127.0.0.1:58272 - "GET / HTTP/1.1" 200
2025-09-22 19:00:38 INFO [sicp_service.manager] Setting LED on guest to True #00FFFF
2025-09-22 19:00:38 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 00 FF FF FA
2025-09-22 19:00:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:40 INFO [uvicorn.access] 127.0.0.1:58272 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:00:40 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-163' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:00:40 INFO [uvicorn.access] 127.0.0.1:58272 - "GET / HTTP/1.1" 200
2025-09-22 19:00:40 INFO [sicp_service.manager] Setting LED on guest to True #FF0000
2025-09-22 19:00:40 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 19:00:41 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:41 INFO [uvicorn.access] 127.0.0.1:58272 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:00:42 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-166' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:00:42 INFO [uvicorn.access] 127.0.0.1:58272 - "GET / HTTP/1.1" 200
2025-09-22 19:00:42 INFO [sicp_service.manager] Setting LED on guest to True #FFFFFF
2025-09-22 19:00:42 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF FF FF 05
2025-09-22 19:00:43 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:44 INFO [uvicorn.access] 127.0.0.1:58272 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:00:44 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-169' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:00:44 INFO [uvicorn.access] 127.0.0.1:58272 - "GET / HTTP/1.1" 200
2025-09-22 19:00:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:45 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:00:46 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-171' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:00:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:46 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:00:47 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:00:47 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-172' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:00:47 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-173' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:00:48 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:49 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:00:49 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-174' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:00:49 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 19:00:50 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: [Errno 65] No route to host
2025-09-22 19:00:51 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: [Errno 64] Host is down
2025-09-22 19:00:51 WARNING [sicp_service.manager] Communication failure with office: Unable to reach 192.168.2.98:5000: [Errno 64] Host is down
2025-09-22 19:00:51 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-175' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:00:56 INFO [sicp_service.manager] Setting LED on guest to True #FF00FF
2025-09-22 19:00:56 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 19:00:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:57 INFO [uvicorn.access] 127.0.0.1:58302 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:00:57 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-178' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:00:57 INFO [uvicorn.access] 127.0.0.1:58302 - "GET / HTTP/1.1" 200
2025-09-22 19:00:57 INFO [sicp_service.manager] Setting LED on guest to True #FFFF00
2025-09-22 19:00:57 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF FF 00 FA
2025-09-22 19:00:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:00:59 INFO [uvicorn.access] 127.0.0.1:58302 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:00:59 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-181' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:00:59 INFO [uvicorn.access] 127.0.0.1:58302 - "GET / HTTP/1.1" 200
2025-09-22 19:01:02 INFO [sicp_service.manager] Setting LED on guest to True #00FF00
2025-09-22 19:01:02 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 19:01:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:03 INFO [uvicorn.access] 127.0.0.1:58302 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:01:03 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-184' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:03 INFO [uvicorn.access] 127.0.0.1:58302 - "GET / HTTP/1.1" 200
2025-09-22 19:01:04 INFO [sicp_service.manager] Setting LED on guest to True #0000FF
2025-09-22 19:01:04 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 19:01:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:06 INFO [uvicorn.access] 127.0.0.1:58302 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:01:06 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-187' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:06 INFO [uvicorn.access] 127.0.0.1:58302 - "GET / HTTP/1.1" 200
2025-09-22 19:01:07 INFO [sicp_service.manager] Setting LED on guest to True #FF0000
2025-09-22 19:01:07 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 19:01:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:08 INFO [uvicorn.access] 127.0.0.1:58302 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:01:08 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-190' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:08 INFO [uvicorn.access] 127.0.0.1:58302 - "GET / HTTP/1.1" 200
2025-09-22 19:01:08 INFO [sicp_service.manager] Setting LED on guest to True #FF00FF
2025-09-22 19:01:08 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 19:01:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:10 INFO [uvicorn.access] 127.0.0.1:58302 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:01:10 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-193' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:10 INFO [uvicorn.access] 127.0.0.1:58302 - "GET / HTTP/1.1" 200
2025-09-22 19:01:11 INFO [sicp_service.manager] Setting LED on guest to True #FF0000
2025-09-22 19:01:11 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 19:01:12 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:13 INFO [uvicorn.access] 127.0.0.1:58302 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:01:13 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-196' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:13 INFO [uvicorn.access] 127.0.0.1:58302 - "GET / HTTP/1.1" 200
2025-09-22 19:01:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:17 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:01:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:18 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:01:18 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:01:18 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-198' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:18 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-199' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:18 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-200' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:19 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:01:20 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-201' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:21 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:01:26 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-202' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:48 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:48 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:48 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:48 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:01:48 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:01:49 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-203' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:49 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:01:49 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-204' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:49 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-205' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:01:51 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-206' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:01:56 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:01:59 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:01:59 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-207' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:02:19 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:02:19 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:02:19 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:02:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:02:20 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:02:20 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-208' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:02:20 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-209' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:02:21 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:02:21 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:02:22 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:02:22 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-210' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:02:22 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-211' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:02:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:02:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:02:30 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-212' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:02:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:02:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:02:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:02:51 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:02:51 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-213' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:02:51 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-214' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:02:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:02:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:02:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:02:53 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-215' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:02:55 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:02:55 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-216' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:00 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:03:01 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-217' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:21 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:21 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:22 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:03:22 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:03:22 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-218' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:22 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-219' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:23 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:24 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:03:24 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-220' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:25 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:03:27 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-221' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:31 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:35 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:03:36 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-222' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:51 INFO [sicp_service.manager] Setting LED on guest to True #00FF00
2025-09-22 19:03:51 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 19:03:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:52 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:03:53 INFO [uvicorn.access] 127.0.0.1:58391 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:03:53 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-225' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:53 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:03:53 INFO [uvicorn.access] 127.0.0.1:58391 - "GET / HTTP/1.1" 200
2025-09-22 19:03:53 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-227' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:53 INFO [sicp_service.manager] Setting LED on guest to True #0000FF
2025-09-22 19:03:53 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 19:03:53 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-160' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttError('Operation timed out')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 474, in publish
    await self._wait_for(confirmation.wait(), timeout=timeout)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 636, in _wait_for
    raise MqttError("Operation timed out") from None
asyncio_mqtt.error.MqttError: Operation timed out
2025-09-22 19:03:53 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-229' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:55 INFO [uvicorn.access] 127.0.0.1:58391 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:03:55 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-230' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:55 INFO [uvicorn.access] 127.0.0.1:58391 - "GET / HTTP/1.1" 200
2025-09-22 19:03:55 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:03:56 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-232' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:56 INFO [sicp_service.manager] Setting LED on guest to True #FF00FF
2025-09-22 19:03:56 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 19:03:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:03:58 INFO [uvicorn.access] 127.0.0.1:58391 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:03:58 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-234' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:03:58 INFO [uvicorn.access] 127.0.0.1:58391 - "GET / HTTP/1.1" 200
2025-09-22 19:04:00 INFO [sicp_service.manager] Setting LED on guest to True #FF0000
2025-09-22 19:04:00 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 19:04:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:01 INFO [uvicorn.access] 127.0.0.1:58391 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:04:01 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-237' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:04:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:04:01 INFO [uvicorn.access] 127.0.0.1:58391 - "GET / HTTP/1.1" 200
2025-09-22 19:04:02 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-239' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:04:03 INFO [sicp_service.manager] Setting LED on guest to False #000000
2025-09-22 19:04:03 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:04:04 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:04 WARNING [sicp_service.manager] Communication failure with guest: LED verification failed: expected OFF #000000, got OFF #FF0000
2025-09-22 19:04:04 INFO [uvicorn.access] 127.0.0.1:58391 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:04:04 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-241' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:04:04 INFO [uvicorn.access] 127.0.0.1:58391 - "GET / HTTP/1.1" 200
2025-09-22 19:04:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:07 INFO [sicp_service.manager] Setting LED on guest to True #FF00FF
2025-09-22 19:04:07 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 19:04:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:08 INFO [uvicorn.access] 127.0.0.1:58391 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:04:08 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-244' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:04:08 INFO [uvicorn.access] 127.0.0.1:58391 - "GET / HTTP/1.1" 200
2025-09-22 19:04:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:04:11 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-246' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:04:23 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:23 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:24 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:04:24 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:04:24 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-247' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:04:24 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-248' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:04:26 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:26 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:04:27 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-249' coro=<MQTTManager._handle_state_update() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:234> exception=MqttCodeError('Could not publish message')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 236, in _handle_state_update
    await self._publish_state(tablet_id, state)
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 209, in _publish_state
    await self._client.publish(topics.availability, availability, qos=1, retain=True)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 114, in decorated
    return await method(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 466, in publish
    raise MqttCodeError(info.rc, "Could not publish message")
asyncio_mqtt.error.MqttCodeError: [code:4] The client is not currently connected.
2025-09-22 19:04:28 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:04:28 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 63, in run_service
    await mqtt_manager.stop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 74, in stop
    await self._task
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 81, in _run
    await self._connect_and_loop()
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 95, in _connect_and_loop
    async with Client(
               ~~~~~~^
        hostname=mqtt_cfg.host,
        ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        tls_params=tls_params,
        ^^^^^^^^^^^^^^^^^^^^^^
    ) as client:
    ^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 837, in __aexit__
    raise disc_exc
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 773, in callback
    client.loop_read()
    ~~~~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/paho/mqtt/client.py", line 1556, in loop_read
    rc = self._packet_read()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/paho/mqtt/client.py", line 2370, in _packet_read
    command = self._sock_recv(1)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/paho/mqtt/client.py", line 640, in _sock_recv
    return self._sock.recv(bufsize)
           ~~~~~~~~~~~~~~~^^^^^^^^^
OSError: [Errno 49] Can't assign requested address

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:04:28 ERROR [asyncio] Task exception was never retrieved
future: <Task finished name='Task-11' coro=<MQTTManager._message_loop() done, defined at /Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py:238> exception=MqttError('Disconnected during message iteration')>
Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/mqtt.py", line 239, in _message_loop
    async for message in messages:
    ...<7 lines>...
        await self._process_message(message.topic, payload)
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/asyncio_mqtt/client.py", line 586, in _message_generator
    raise MqttError("Disconnected during message iteration")
asyncio_mqtt.error.MqttError: Disconnected during message iteration
2025-09-22 19:04:30 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:04:30 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:04:30 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:04:30 INFO [uvicorn.error] Started server process [17796]
2025-09-22 19:04:30 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:04:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:04:30 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:04:30 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:04:30 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:04:30 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4413874464
2025-09-22 19:04:30 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:04:30 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:04:30 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:04:30 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:04:30 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:04:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:04:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:04:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:04:30 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:04:30 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:04:31 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:04:31 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:04:31 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:04:31 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:04:31 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:04:31 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:05:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:05:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:05:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:05:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:05:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:05:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:05:01 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:05:02 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:05:05 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:05:06 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:05:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:05:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:05:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:05:32 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:05:32 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:05:32 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:05:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:05:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:05:39 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:05:39 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:06:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:03 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:03 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.71:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:06:03 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.92:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:06:03 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.18:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:06:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:10 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.98:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:06:11 INFO [sicp_service.sicp] SICP GET_POWER -> 192.168.2.189:5000 (expect reply): 05 01 00 19 1D
2025-09-22 19:06:12 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:06:12 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:06:12 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:06:12 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:06:12 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:06:12 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:06:12 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:06:12 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:06:12 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:06:14 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:06:14 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:06:14 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:06:14 INFO [uvicorn.error] Started server process [18004]
2025-09-22 19:06:14 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:06:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:14 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:06:14 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:06:14 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:06:14 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4478968096
2025-09-22 19:06:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:06:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:06:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:06:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:06:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:06:15 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:06:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:06:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:06:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:06:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:06:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:06:26 INFO [uvicorn.access] 127.0.0.1:58504 - "GET / HTTP/1.1" 200
2025-09-22 19:06:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:06:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:18 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:22 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 19:07:28 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: timed out
2025-09-22 19:07:29 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: [Errno 64] Host is down
2025-09-22 19:07:29 WARNING [sicp_service.manager] Communication failure with bathroom: Unable to reach 192.168.2.189:5000: [Errno 64] Host is down
2025-09-22 19:07:36 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:07:36 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:07:36 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:07:36 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:07:36 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:07:36 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:07:36 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:07:36 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:07:36 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:07:37 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:07:37 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:07:37 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:07:37 INFO [uvicorn.error] Started server process [18201]
2025-09-22 19:07:37 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:07:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:07:37 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:07:37 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:07:37 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:07:37 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: [Errno 64] Host is down
2025-09-22 19:07:37 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4452408624
2025-09-22 19:07:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:07:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:07:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:07:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:07:37 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:07:38 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:07:38 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:07:38 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:07:38 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:07:38 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:07:38 WARNING [sicp_service.sicp] Attempt 2/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: [Errno 64] Host is down
2025-09-22 19:07:38 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:07:39 WARNING [sicp_service.sicp] Attempt 3/3 failed communicating with 192.168.2.189:5000: Unable to reach 192.168.2.189:5000: [Errno 64] Host is down
2025-09-22 19:07:39 WARNING [sicp_service.manager] Communication failure with bathroom: Unable to reach 192.168.2.189:5000: [Errno 64] Host is down
2025-09-22 19:07:39 INFO [uvicorn.access] 127.0.0.1:58540 - "GET / HTTP/1.1" 200
2025-09-22 19:07:40 INFO [uvicorn.access] 127.0.0.1:58540 - "GET / HTTP/1.1" 200
2025-09-22 19:08:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:08 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:26 INFO [uvicorn.access] 127.0.0.1:58555 - "GET / HTTP/1.1" 200
2025-09-22 19:08:29 INFO [uvicorn.access] 127.0.0.1:58555 - "GET / HTTP/1.1" 200
2025-09-22 19:08:32 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:08:32 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:08:32 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:08:32 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:08:32 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:08:32 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:08:32 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:08:32 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:08:33 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:08:34 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:08:34 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:08:34 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:08:34 INFO [uvicorn.error] Started server process [18359]
2025-09-22 19:08:34 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:08:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:34 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:08:34 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:08:34 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:08:34 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4454030640
2025-09-22 19:08:34 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:08:34 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:08:34 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:08:34 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:08:34 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:08:34 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:08:35 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:08:35 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:08:35 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:08:35 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:08:35 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:08:36 INFO [uvicorn.access] 127.0.0.1:58569 - "GET / HTTP/1.1" 200
2025-09-22 19:08:36 INFO [uvicorn.access] 127.0.0.1:58569 - "GET / HTTP/1.1" 200
2025-09-22 19:08:42 INFO [sicp_service.manager] Setting LED on hallway to False #000000
2025-09-22 19:08:42 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:08:43 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:43 INFO [sicp_service.manager] Setting LED on office to False #000000
2025-09-22 19:08:43 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:08:43 WARNING [sicp_service.manager] Communication failure with hallway: LED verification failed: expected OFF #000000, got OFF #FFFFFF
2025-09-22 19:08:43 INFO [uvicorn.access] 127.0.0.1:58571 - "POST /api/tablets/hallway/light HTTP/1.1" 200
2025-09-22 19:08:43 INFO [uvicorn.access] 127.0.0.1:58571 - "GET / HTTP/1.1" 200
2025-09-22 19:08:44 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 19:08:44 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:08:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:45 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #00FFFF
2025-09-22 19:08:45 INFO [uvicorn.access] 127.0.0.1:58571 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 19:08:45 INFO [uvicorn.access] 127.0.0.1:58571 - "GET / HTTP/1.1" 200
2025-09-22 19:08:48 WARNING [sicp_service.sicp] Attempt 1/3 failed communicating with 192.168.2.98:5000: Unable to reach 192.168.2.98:5000: timed out
2025-09-22 19:08:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:08:51 WARNING [sicp_service.manager] Communication failure with office: LED verification failed: expected OFF #000000, got OFF #00FFFF
2025-09-22 19:09:04 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:09:04 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:09:04 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:09:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:09:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:09:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:09:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:09:35 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:09:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:09:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:10:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:10:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:10:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:10:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:10:09 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:10:35 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:10:35 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:10:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:10:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:10:40 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:11 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:11 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:11:11 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:11:11 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:11:11 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:11:11 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:11:11 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:11:11 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:11:11 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:11:11 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:11:13 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:11:13 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:11:13 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:11:13 INFO [uvicorn.error] Started server process [18654]
2025-09-22 19:11:13 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:11:13 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:13 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:13 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:13 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:13 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:13 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:11:13 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:11:13 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:11:13 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4421688624
2025-09-22 19:11:13 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:11:13 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:11:13 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:11:13 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:11:14 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:11:14 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:11:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:11:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:11:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:11:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:11:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:11:16 INFO [uvicorn.access] 127.0.0.1:58632 - "GET / HTTP/1.1" 200
2025-09-22 19:11:19 INFO [uvicorn.access] 127.0.0.1:58632 - "GET / HTTP/1.1" 200
2025-09-22 19:11:34 INFO [sicp_service.manager] Setting LED on guest to False #000000
2025-09-22 19:11:34 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:11:34 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:35 WARNING [sicp_service.manager] Communication failure with guest: LED verification failed: expected OFF #000000, got OFF #FF00FF
2025-09-22 19:11:35 INFO [uvicorn.access] 127.0.0.1:58640 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:11:35 INFO [uvicorn.access] 127.0.0.1:58640 - "GET / HTTP/1.1" 200
2025-09-22 19:11:41 INFO [sicp_service.manager] Setting LED on guest to True #00FFFF
2025-09-22 19:11:41 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 00 FF FF FA
2025-09-22 19:11:42 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:42 INFO [uvicorn.access] 127.0.0.1:58644 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:11:43 INFO [uvicorn.access] 127.0.0.1:58644 - "GET / HTTP/1.1" 200
2025-09-22 19:11:43 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:45 INFO [sicp_service.manager] Setting LED on guest to False #000000
2025-09-22 19:11:45 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:11:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:11:46 WARNING [sicp_service.manager] Communication failure with guest: LED verification failed: expected OFF #000000, got OFF #00FFFF
2025-09-22 19:11:46 INFO [uvicorn.access] 127.0.0.1:58644 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:11:46 INFO [uvicorn.access] 127.0.0.1:58644 - "GET / HTTP/1.1" 200
2025-09-22 19:12:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:12:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:12:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:12:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:12:19 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:12:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:12:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:12:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:12:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:12:49 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:15 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:16 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:20 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:21 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:45 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:51 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:13:51 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:13:51 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:13:51 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:13:51 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:13:51 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:13:51 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:13:51 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:13:51 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:13:54 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:13:54 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:13:54 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:13:54 INFO [uvicorn.error] Started server process [18927]
2025-09-22 19:13:54 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:13:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:54 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:13:54 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:13:54 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:13:54 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:13:54 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4480262768
2025-09-22 19:13:54 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:13:54 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:13:54 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:13:54 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:13:54 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:13:55 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:13:55 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:13:55 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:13:55 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:13:55 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:13:55 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:13:59 INFO [uvicorn.access] 127.0.0.1:58713 - "GET / HTTP/1.1" 200
2025-09-22 19:14:05 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 19:14:05 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:14:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:06 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #00FFFF
2025-09-22 19:14:06 INFO [uvicorn.access] 127.0.0.1:58715 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 19:14:06 INFO [uvicorn.access] 127.0.0.1:58715 - "GET / HTTP/1.1" 200
2025-09-22 19:14:15 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:14:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:14:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:14:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:14:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:14:15 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:14:15 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:14:15 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:14:15 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:14:17 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:14:17 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:14:17 INFO [uvicorn.error] Started server process [19043]
2025-09-22 19:14:17 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:14:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:17 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:14:17 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:14:17 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4417756800
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:14:17 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:14:17 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:14:18 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:14:19 INFO [uvicorn.access] 127.0.0.1:58731 - "GET / HTTP/1.1" 200
2025-09-22 19:14:21 INFO [uvicorn.access] 127.0.0.1:58731 - "GET / HTTP/1.1" 200
2025-09-22 19:14:22 INFO [uvicorn.access] 127.0.0.1:58731 - "GET / HTTP/1.1" 200
2025-09-22 19:14:23 INFO [uvicorn.access] 127.0.0.1:58731 - "GET / HTTP/1.1" 200
2025-09-22 19:14:25 INFO [sicp_service.manager] Setting LED on spare to False #000000
2025-09-22 19:14:25 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:14:25 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:25 WARNING [sicp_service.manager] Communication failure with spare: LED verification failed: expected OFF #000000, got OFF #00FFFF
2025-09-22 19:14:25 INFO [uvicorn.access] 127.0.0.1:58731 - "POST /api/tablets/spare/light HTTP/1.1" 200
2025-09-22 19:14:25 INFO [uvicorn.access] 127.0.0.1:58731 - "GET / HTTP/1.1" 200
2025-09-22 19:14:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:47 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:14:50 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:04 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:15:04 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:15:04 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:15:04 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:15:04 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:15:04 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:15:04 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:15:04 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:15:04 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:15:05 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:15:05 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:15:05 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:15:05 INFO [uvicorn.error] Started server process [19183]
2025-09-22 19:15:05 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:15:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:05 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:15:05 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:15:05 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:15:06 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4414694000
2025-09-22 19:15:06 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:15:06 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:15:06 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:15:06 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:15:06 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:15:06 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:15:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:15:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:15:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:15:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:15:07 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:15:08 INFO [uvicorn.access] 127.0.0.1:58760 - "GET / HTTP/1.1" 200
2025-09-22 19:15:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:38 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:40 INFO [uvicorn.access] 127.0.0.1:58780 - "GET / HTTP/1.1" 200
2025-09-22 19:15:44 INFO [sicp_service.manager] Setting LED on guest to True #FFFF00
2025-09-22 19:15:44 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF FF 00 FA
2025-09-22 19:15:44 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:45 INFO [uvicorn.access] 127.0.0.1:58780 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:15:45 INFO [uvicorn.access] 127.0.0.1:58780 - "GET / HTTP/1.1" 200
2025-09-22 19:15:46 INFO [sicp_service.manager] Setting LED on guest to True #FF00FF
2025-09-22 19:15:46 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF 00 FF FA
2025-09-22 19:15:46 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:47 INFO [uvicorn.access] 127.0.0.1:58780 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:15:47 INFO [uvicorn.access] 127.0.0.1:58780 - "GET / HTTP/1.1" 200
2025-09-22 19:15:48 INFO [sicp_service.manager] Setting LED on guest to True #00FFFF
2025-09-22 19:15:48 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 00 FF FF FA
2025-09-22 19:15:49 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:49 INFO [uvicorn.access] 127.0.0.1:58780 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:15:49 INFO [uvicorn.access] 127.0.0.1:58780 - "GET / HTTP/1.1" 200
2025-09-22 19:15:50 INFO [sicp_service.manager] Setting LED on guest to True #0000FF
2025-09-22 19:15:50 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 00 00 FF 05
2025-09-22 19:15:51 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:51 INFO [uvicorn.access] 127.0.0.1:58780 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:15:51 INFO [uvicorn.access] 127.0.0.1:58780 - "GET / HTTP/1.1" 200
2025-09-22 19:15:52 INFO [sicp_service.manager] Setting LED on guest to True #00FF00
2025-09-22 19:15:52 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 00 FF 00 05
2025-09-22 19:15:53 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:53 INFO [uvicorn.access] 127.0.0.1:58780 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:15:53 INFO [uvicorn.access] 127.0.0.1:58780 - "GET / HTTP/1.1" 200
2025-09-22 19:15:54 INFO [sicp_service.manager] Setting LED on guest to True #FF0000
2025-09-22 19:15:54 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF 00 00 05
2025-09-22 19:15:55 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:55 INFO [uvicorn.access] 127.0.0.1:58780 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:15:55 INFO [uvicorn.access] 127.0.0.1:58780 - "GET / HTTP/1.1" 200
2025-09-22 19:15:56 INFO [sicp_service.manager] Setting LED on guest to True #FFFFFF
2025-09-22 19:15:56 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF FF FF 05
2025-09-22 19:15:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:15:57 INFO [uvicorn.access] 127.0.0.1:58780 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:15:57 INFO [uvicorn.access] 127.0.0.1:58780 - "GET / HTTP/1.1" 200
2025-09-22 19:15:59 INFO [sicp_service.manager] Setting LED on guest to False #000000
2025-09-22 19:15:59 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:15:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:00 WARNING [sicp_service.manager] Communication failure with guest: LED verification failed: expected OFF #000000, got OFF #FFFFFF
2025-09-22 19:16:00 INFO [uvicorn.access] 127.0.0.1:58780 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:16:00 INFO [uvicorn.access] 127.0.0.1:58780 - "GET / HTTP/1.1" 200
2025-09-22 19:16:04 INFO [sicp_service.manager] Setting LED on guest to False #000000
2025-09-22 19:16:04 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:16:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:05 WARNING [sicp_service.manager] Communication failure with guest: LED verification failed: expected OFF #000000, got OFF #FFFFFF
2025-09-22 19:16:05 INFO [uvicorn.access] 127.0.0.1:58780 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:16:05 INFO [uvicorn.access] 127.0.0.1:58780 - "GET / HTTP/1.1" 200
2025-09-22 19:16:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:07 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:10 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:37 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:38 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:38 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:16:41 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:03 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:17:03 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:17:03 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:17:03 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:17:03 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:17:03 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:17:03 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:17:03 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:17:03 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:17:05 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:17:05 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:17:05 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:17:05 INFO [uvicorn.error] Started server process [19412]
2025-09-22 19:17:05 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:17:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:05 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:17:05 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:17:05 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:17:05 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4423589168
2025-09-22 19:17:05 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:17:05 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:17:05 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:17:05 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:17:05 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:17:05 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:17:06 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:17:06 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:17:06 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:17:06 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:17:06 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:17:09 INFO [uvicorn.access] 127.0.0.1:58842 - "GET / HTTP/1.1" 200
2025-09-22 19:17:10 INFO [sicp_service.manager] Setting LED on guest to True #FFFF00
2025-09-22 19:17:10 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF FF 00 FA
2025-09-22 19:17:11 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:11 INFO [uvicorn.access] 127.0.0.1:58842 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:17:11 INFO [uvicorn.access] 127.0.0.1:58842 - "GET / HTTP/1.1" 200
2025-09-22 19:17:14 INFO [sicp_service.manager] Setting LED on guest to False #000000
2025-09-22 19:17:14 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:17:14 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:15 WARNING [sicp_service.manager] Communication failure with guest: LED verification failed: expected OFF #000000, got OFF #FFFF00
2025-09-22 19:17:15 INFO [uvicorn.access] 127.0.0.1:58842 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:17:15 INFO [uvicorn.access] 127.0.0.1:58842 - "GET / HTTP/1.1" 200
2025-09-22 19:17:35 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:35 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:35 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:35 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:17:36 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:05 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:06 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:27 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:18:27 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:18:27 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:18:27 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:18:27 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:18:27 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:18:27 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:18:27 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:18:27 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:18:29 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:18:29 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:18:29 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:18:29 INFO [uvicorn.error] Started server process [19575]
2025-09-22 19:18:29 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:18:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:29 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:18:29 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:18:29 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:18:29 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4451050096
2025-09-22 19:18:29 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:18:29 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:18:29 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:18:29 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:18:29 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:18:30 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:18:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:18:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:18:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:18:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:18:30 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:18:36 INFO [uvicorn.access] 127.0.0.1:58896 - "GET / HTTP/1.1" 200
2025-09-22 19:18:38 INFO [sicp_service.manager] Setting LED on guest to True #FFFF00
2025-09-22 19:18:38 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF FF 00 FA
2025-09-22 19:18:39 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:18:39 INFO [uvicorn.access] 127.0.0.1:58896 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:18:39 INFO [uvicorn.access] 127.0.0.1:58896 - "GET / HTTP/1.1" 200
2025-09-22 19:18:59 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:00 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:00 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:00 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:01 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:24 INFO [sicp_service.manager] Setting LED on guest to False #000000
2025-09-22 19:19:24 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:19:25 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:25 INFO [uvicorn.access] 127.0.0.1:58909 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:19:25 INFO [uvicorn.access] 127.0.0.1:58909 - "GET / HTTP/1.1" 200
2025-09-22 19:19:29 INFO [sicp_service.manager] Setting LED on guest to True #FFFFFF
2025-09-22 19:19:29 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 01 FF FF FF 05
2025-09-22 19:19:29 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:29 INFO [uvicorn.access] 127.0.0.1:58909 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:19:29 INFO [uvicorn.access] 127.0.0.1:58909 - "GET / HTTP/1.1" 200
2025-09-22 19:19:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:30 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:32 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:56 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:19:56 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:19:56 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:19:56 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:19:56 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:19:56 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:19:56 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:19:56 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:19:56 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-09-22 19:19:57 INFO [sicp_service.manager] Starting tablet manager with 5 tablets
2025-09-22 19:19:57 INFO [sicp_service.mqtt] Starting MQTT manager
2025-09-22 19:19:57 INFO [__main__] Web server listening on 127.0.0.1:8080
2025-09-22 19:19:57 INFO [uvicorn.error] Started server process [19760]
2025-09-22 19:19:57 INFO [uvicorn.error] Waiting for application startup.
2025-09-22 19:19:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.189:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.92:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.98:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:57 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.71:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:19:57 INFO [sicp_service.mqtt] Connecting to MQTT broker 192.168.2.44:1883
2025-09-22 19:19:57 INFO [uvicorn.error] Application startup complete.
2025-09-22 19:19:57 INFO [uvicorn.error] Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
2025-09-22 19:19:57 INFO [sicp_service.mqtt] Connected to MQTT broker 192.168.2.44:1883 as sicp-4489944368
2025-09-22 19:19:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for bathroom
2025-09-22 19:19:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for guest
2025-09-22 19:19:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for hallway
2025-09-22 19:19:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for office
2025-09-22 19:19:57 INFO [sicp_service.mqtt] Published Home Assistant discovery for spare
2025-09-22 19:19:58 WARNING [mqtt] unfiltered_messages() is deprecated and will be removed in a future version. Use messages() instead.
2025-09-22 19:19:58 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> online
2025-09-22 19:19:58 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> online
2025-09-22 19:19:58 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> online
2025-09-22 19:19:58 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> online
2025-09-22 19:19:58 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> online
2025-09-22 19:19:59 INFO [uvicorn.access] 127.0.0.1:58937 - "GET / HTTP/1.1" 200
2025-09-22 19:20:04 INFO [sicp_service.manager] Setting LED on guest to False #000000
2025-09-22 19:20:04 INFO [sicp_service.sicp] SICP SET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F3 00 00 00 00 FB
2025-09-22 19:20:04 INFO [sicp_service.sicp] SICP GET_LED -> 192.168.2.18:5000 (expect reply): 09 01 00 F4 00 00 00 00 FC
2025-09-22 19:20:04 INFO [uvicorn.access] 127.0.0.1:58937 - "POST /api/tablets/guest/light HTTP/1.1" 200
2025-09-22 19:20:04 INFO [uvicorn.access] 127.0.0.1:58937 - "GET / HTTP/1.1" 200
2025-09-22 19:20:18 INFO [sicp_service.mqtt] Stopping MQTT manager
2025-09-22 19:20:18 INFO [sicp_service.mqtt] Published availability sicp_tablets/bathroom/availability -> offline
2025-09-22 19:20:18 INFO [sicp_service.mqtt] Published availability sicp_tablets/guest/availability -> offline
2025-09-22 19:20:18 INFO [sicp_service.mqtt] Published availability sicp_tablets/hallway/availability -> offline
2025-09-22 19:20:18 INFO [sicp_service.mqtt] Published availability sicp_tablets/office/availability -> offline
2025-09-22 19:20:18 INFO [sicp_service.mqtt] Published availability sicp_tablets/spare/availability -> offline
2025-09-22 19:20:18 INFO [sicp_service.mqtt] Disconnected from MQTT broker 192.168.2.44:1883
2025-09-22 19:20:18 INFO [sicp_service.manager] Stopping tablet manager
2025-09-22 19:20:18 ERROR [uvicorn.error] Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/abhivatsya/Code/sicp_client/sicp_service/main.py", line 61, in run_service
    await server.serve()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 82, in serve
    await self.main_loop()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 233, in main_loop
    await asyncio.sleep(0.1)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/starlette/routing.py", line 743, in lifespan
    await receive()
  File "/Users/abhivatsya/Code/sicp_client/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

